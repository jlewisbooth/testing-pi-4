# Communications Server

This server is the central part of all packets generated by each project. Here the packets are parsed and reformatted to then be sent onto a subscriber, i.e. the web server.

## Communication Tech

There are two protocols used here:

- UDP Datagram
- WebSocket

For high frequency projects, such as the tower bridge, it's much easier and quicker to use a UDP, as you don't care if you miss any packets. For low frequency, a WebSocket is more reliable and safer.

## Packet Protocol - Frontend

These structures represent what is sent too and from the frontend, not what is recieved from model locations.

**General Structure**

```json
{
    "locationId": string, // this is unique to the different models
    "type": "tof" | "tilt" | "env" | "light" | "power" | "ppv", // this is to define the type of data struct
    "data": {
        ...
    },
    "timestamp": string
}
```

**tof**

```json
{
    "locationId": string, // this is unique to the different models
    "type": "tof", // this is to define the type of data struct
    "data": {
        "present": boolean
    },
    "timestamp": string
}
```

**tilt**

```json
{
    "locationId": string, // this is unique to the different models
    "type": "tilt", // this is to define the type of data struct
    "data": {
        "sensorId": string,
        "value": number,
    },
    "timestamp": string
}
```

**env**

```json
{
    "locationId": string, // this is unique to the different models
    "type": "env", // this is to define the type of data struct
    "data": {
        "temperature": number,
        "humidity": number,
        "pressure": number
    },
    "timestamp": string
}
```

**light**

```json
{
    "locationId": string, // this is unique to the different models
    "type": "light", // this is to define the type of data struct
    "data": {
        "actionId": string
    },
    "timestamp": string
}
```

**power**

```json
{
    "locationId": string, // this is unique to the different models
    "type": "power", // this is to define the type of data struct
    "data": {
        "throttle": number, // between 0 and 1
        "direction": "clockwise" | "anti-clockwise"
    },
    "timestamp": string
}
```

**ppv**

```json
{
    "locationId": string, // this is unique to the different models
    "type": "ppv", // this is to define the type of data struct
    "data": {
        "sensorId": string,
        "x": number,
        "y": number,
        "z": number
    },
    "timestamp": string
}
```
